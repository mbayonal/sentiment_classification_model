schema: '2.0'
stages:
  download_data:
    cmd: python src/data/download_data.py
    deps:
    - path: src/data/download_data.py
      hash: md5
      md5: 0b42625466258c96a0063b15b02d57ea
      size: 6666
    params:
      params.yaml:
        SAMPLING_RATIOS:
          title.akas.tsv.gz: 0.05
          title.basics.tsv.gz: 0.1
          title.crew.tsv.gz: 0.1
          title.episode.tsv.gz: 0.1
          title.principals.tsv.gz: 0.05
          title.ratings.tsv.gz: 0.2
          name.basics.tsv.gz: 0.05
        TARGET_SIZE_MB: 100
    outs:
    - path: data/raw/name.basics.tsv.gz
      hash: md5
      md5: e586368b285c2675df6b895d859de267
      size: 18420408
    - path: data/raw/title.basics.tsv.gz
      hash: md5
      md5: 3ff295d36a5d23f2bed6ed0dd3e7c927
      size: 28885914
    - path: data/raw/title.crew.tsv.gz
      hash: md5
      md5: 1d4fb5410edd2a40dbfcffe991c7926a
      size: 78637345
    - path: data/raw/title.episode.tsv.gz
      hash: md5
      md5: 50a6060e54e00bbe540878400228f596
      size: 51319736
    - path: data/raw/title.principals.tsv.gz
      hash: md5
      md5: 9702617cc511ecb4aef2c7d561b6ef7f
      size: 74718981
    - path: data/raw/title.ratings.tsv.gz
      hash: md5
      md5: 591a3f852d1018b3bd87419b9a9500be
      size: 8231246
  preprocess_data:
    cmd: python src/data/preprocess_data.py
    deps:
    - path: data/raw/name.basics.tsv.gz
      hash: md5
      md5: e586368b285c2675df6b895d859de267
      size: 18420408
    - path: data/raw/title.basics.tsv.gz
      hash: md5
      md5: 3ff295d36a5d23f2bed6ed0dd3e7c927
      size: 28885914
    - path: data/raw/title.crew.tsv.gz
      hash: md5
      md5: 1d4fb5410edd2a40dbfcffe991c7926a
      size: 78637345
    - path: data/raw/title.episode.tsv.gz
      hash: md5
      md5: 50a6060e54e00bbe540878400228f596
      size: 51319736
    - path: data/raw/title.principals.tsv.gz
      hash: md5
      md5: 9702617cc511ecb4aef2c7d561b6ef7f
      size: 74718981
    - path: data/raw/title.ratings.tsv.gz
      hash: md5
      md5: 591a3f852d1018b3bd87419b9a9500be
      size: 8231246
    - path: src/data/preprocess_data.py
      hash: md5
      md5: 50a6c361854aee1bd708ccb7ad1aa8f4
      size: 8418
    outs:
    - path: data/processed/name.basics.tsv
      hash: md5
      md5: 120eb2ca51083de7caa7f2a66769d09a
      size: 51154086
    - path: data/processed/title.akas.tsv
      hash: md5
      md5: 6ecb1b0fbfac00d53efe3974cd17fd09
      size: 151467578
    - path: data/processed/title.basics.tsv
      hash: md5
      md5: 244f550b04215183792a24919a69bad7
      size: 115814855
    - path: data/processed/title.crew.tsv
      hash: md5
      md5: cc1d02cf30392810555486bf9d306cdb
      size: 492146966
    - path: data/processed/title.episode.tsv
      hash: md5
      md5: 1b343ff058bf6684fcdaaf11b3c063bd
      size: 274923302
    - path: data/processed/title.principals.tsv
      hash: md5
      md5: d5a978dec7a294935a1bbdddd70efc77
      size: 222634821
    - path: data/processed/title.ratings.tsv
      hash: md5
      md5: c18960a179216643128bb38d0fb00c7d
      size: 30111548
  build_features:
    cmd: python src/features/build_features.py
    deps:
    - path: data/processed/title.basics.tsv
      hash: md5
      md5: 244f550b04215183792a24919a69bad7
      size: 115814855
    - path: data/processed/title.ratings.tsv
      hash: md5
      md5: c18960a179216643128bb38d0fb00c7d
      size: 30111548
    - path: src/features/build_features.py
      hash: md5
      md5: 9f9c669c9fb66db900b0b93d4c8cb095
      size: 4882
    outs:
    - path: data/processed/features/movie_features.csv
      hash: md5
      md5: 13c30d6f02e52eeac2e1bbacdf29a673
      size: 8784871
  train_rating_classifier:
    cmd: python src/models/train_rating_classifier.py
    deps:
    - path: data/processed/features/movie_features.csv
      hash: md5
      md5: 259ca5e69a4c0396c8a34630fc5ce184
      size: 8646556
    - path: src/models/train_rating_classifier.py
      hash: md5
      md5: c553a5bac3d7c10aeb0e1c9b82b77e72
      size: 8073
    params:
      params.yaml:
        rating_classifier:
          test_size: 0.2
          random_state: 42
          logistic_regression:
            C: 1.0
            max_iter: 1000
          linear_svm:
            C: 1.0
            max_iter: 2000
    outs:
    - path: models/best_model.pkl
      hash: md5
      md5: d026e1cc892db712c40e1d2656a66b51
      size: 4822
    - path: models/best_model_metadata.json
      hash: md5
      md5: c07b0e5d7c4a10e1206a1e8902cc2d5d
      size: 557
